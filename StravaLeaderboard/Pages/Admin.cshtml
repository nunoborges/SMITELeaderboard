@page
@using StravaLeaderboard.models
@model AdminModel

<div class="left-side">
    @(Html.DevExtreme().SelectBox()
        .DataSource(Model.ClubsSelection.ToList())
        .DisplayExpr("Name")
        .ValueExpr("ClubID")
        .Value(1)
        .OnValueChanged(@<text>
        function(data) {
            var dataGrid = $("#seasonGrid").dxDataGrid("instance");
            dataGrid.filter(["ClubID", "=", data.value]);
        }
        </text>)
    )
</div>

@(Html.DevExtreme().DataGrid<Season>()
        .ID("seasonGrid")
        .DataSource(Model.Seasons.ToList())
        //.KeyExpr("SeasonID")
        .Selection(s => s.Mode(SelectionMode.Single))
        .ColumnAutoWidth(true)
        .Columns(columns =>
        {
            columns.Add()
                .DataField("SeasonID")
                .Caption("Season ID");
            columns.Add()
                .DataField("Start_date")
                .Caption("Start Date")
                .DataType(GridColumnDataType.Date);
            columns.Add()
                .DataField("End_date")
                .Caption("End Date")
                .DataType(GridColumnDataType.Date);
            columns.Add()
                .DataField("Keyword");
        })
        .OnSelectionChanged(@<text>
        function(data) {
            var d = data.selectedRowsData[0];
            var dataGrid = $("#dayeventGrid").dxDataGrid("instance");
            dataGrid.filter(["SeasonID", "=", d.SeasonID]);
        }
        </text>)
)



@(Html.DevExtreme().DataGrid<DayEvent>()
        .ID("dayeventGrid")
        .DataSource(Model.DayEvents.ToList())
        .Selection(s => s.Mode(SelectionMode.Single))
        .OnSelectionChanged(@<text>
        function(data) {
            var d = data.selectedRowsData[0];
            var dataGrid = $("#eventsegmentGrid").dxDataGrid("instance");
            dataGrid.filter(["DayEventID", "=", d.DayEventID]);
        }
        </text>)
)

@(Html.DevExtreme().DataGrid<EventSegment>()
        .DataSource(Model.EventSegments.ToList())
        .ID("eventsegmentGrid")
)
